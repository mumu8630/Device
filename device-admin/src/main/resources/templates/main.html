<!DOCTYPE html>
<html  lang="zh" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!--360浏览器优先以webkit内核解析-->
    <title>首页展示</title>
    <link rel="shortcut icon" href="favicon.ico">
    <link href="../static/css/bootstrap.min.css" th:href="@{/css/bootstrap.min.css}" rel="stylesheet"/>
    <link href="../static/css/font-awesome.min.css" th:href="@{/css/font-awesome.min.css}" rel="stylesheet"/>
    <link href="../static/css/style.min.css" th:href="@{/css/style.min.css}" rel="stylesheet"/>
</head>
<!--首页展示页面-->
<body class="gray-bg">
    <div class="row border-bottom white-bg dashboard-header">
        <div class="col-sm-12">
            <blockquote class="text-warning" style="font-size:14px">
				1、探索、求知、明理。
				<br>
				2、大胆探索，反复实验。
				<br>
				3、细心观察，认真分析，科学总结
				<br>
				4、有知识的人不实践，等于一只蜜蜂不酿蜜。
				<br>
				5、一个人，只有在实践中运用能力，才能知道自己的能力。
            </blockquote>
        </div>
		<hr>
        <div class="col-sm-3">
			<div class="ibox">
				<div class="ibox-content"   >
					<h4>任务列表</h4>
					<p class="small"><i class="fa fa-hand-o-up"></i> 合理的规划 自律的自己</p>
					<div class="input-group">
						<input type="text" id="task" placeholder="添加新任务" class="input input-sm form-control">
						<span class="input-group-btn">
							<button type="button" class="btn btn-sm btn-white" onclick="addTask()"> <i class="fa fa-plus"></i> 添加</button>
						</span>
					</div>
					<ul class="sortable-list connectList agile-list" id="taskList" style="padding: 0px; margin-bottom : 0px">
						<li class="warning-element" th:each="task:${tasks}">
							<span th:text="${task.taskDescription}"></span>
							<div class="agile-detail">
								<a href="javascript:;" class="pull-right btn btn-xs btn-white" th:onclick="'deleteTaskByTestId(' + ${task.taskId} +')'">删除</a>
								<!-- 根据 taskStatus 来设置按钮样式和文字 -->
								<a th:if="${task.taskStatus == '未完成'}" href="javascript:;" class="pull-right btn btn-xs btn-white" th:onclick="'updateTaskStatus('+ ${task.taskId}+')'">去完成</a>
								<a th:if="${task.taskStatus == '已完成'}" href="javascript:;" class="pull-right btn btn-xs btn-primary"  th:onclick="'updateTaskStatus('+ ${task.taskId}+')'">已完成</a>
								<i class="fa fa-clock-o"></i> <span th:text="${#dates.format(task.taskCreateTime, 'yyyy-MM-dd')}"></span>
							</div>
						</li>
					</ul>
				</div>
			</div>
        </div>
        <div class="col-sm-5">
			<br>
			<br>
			<div id="main-chart" style="width: 500px;height:300px;"></div>
        </div>
        <div class="col-sm-4">
			<br><br>
            <h4>今日公告：</h4>
            <ol>
				<li>失物招领。</li>
                <li>维护实验器材是每位学生和老师应尽的义务。</li>
				<li>系统将在本周二进行维护,期间无法进行借用与归还。</li>
				<li>请首次登录用户进行个人信息补充。</li>
				<li>切勿泄露个人信息，保障账号安全。</li>
				<li>借用与归还实验室设备的默认期限为<span style="color: red">3</span>天。</li>
                <li>更多……</li>
            </ol>
        </div>

    </div>
    <div class="wrapper wrapper-content">
        <div class="row">
            <div class="col-sm-4">

                <div class="ibox float-e-margins">
                    <div class="ibox-title">
                        <h5>联系信息</h5>

                    </div>
                    <div class="ibox-content">
                        <p><i class="fa fa-send-o"></i> 官网：<a href="http://www.ruoyi.vip" target="_blank">http://www.ruoyi.vip</a>
                        </p>
                        <p><i class="fa fa-qq"></i> QQ群：<s>满1389287</s> <s>满1679294</s> <s>满1529866</s> <s>满1772718</s> <s>满1366522</s> <s>满1382251</s> <s>满1145125</s> <s>满86752435</s> <s>满134072510</s> <s>满210336300</s> <s>满339522636</s> <s>满130035985</s> <s>满143151071</s> <s>满158781320</s> <s>满201531282</s> <s>满101526938</s> <s>满264355400</s> <s>满298522656</s> <s>满139845794</s>  <s>满185760789</s> <s>满175104288</s> <a href="http://qm.qq.com/cgi-bin/qm/qr?_wv=1027&k=lqMHu_5Fskm7H2S1vNAQTtzAUokVydwc&authKey=ptw0Fpch5pbNocML3CIJKKqZBaq2DI7cusKuzIgfMNiY3t9Pvd9hP%2BA8WYx3yaY1&noverify=0&group_code=174942938" target="_blank">174942938 </a>
                        </p>
                        <p><i class="fa fa-weixin"></i> 微信：<a href="javascript:;">/ *若依</a>
                        </p>
                        <p><i class="fa fa-credit-card"></i> 支付宝：<a href="javascript:;" class="支付宝信息">/ *若依</a>
                        </p>
                    </div>
                </div>
            </div>
            <div class="col-sm-4">
                <div class="ibox float-e-margins">
                    <div class="ibox-title">
                        <h5>项目相关</h5>
                    </div>
                    <div class="ibox-content no-padding">
                        <div class="panel-body">
                            <div class="panel-group" id="version">
                            <div class="panel panel-default">
								<div class="panel-heading">
								   <h5 class="panel-title">
									   <a data-toggle="collapse" data-parent="#version" href="#v478">相关技术</a></code>
								   </h5>
								</div>
								<div id="v478" class="panel-collapse collapse in">
									<div class="panel-body">
									   <ol>
										   	<li>基本语言: Java 1.8</li>
									        <li>项目框架: SpringBoot 3.0.0</li>
									        <li>数据库: Mysql 8.0.19</li>
									        <li>持久层框架: Mybatis </li>
										    <li>数据库连接池: Druid 1.2.20</li>
										    <li>安全框架: Apache Shiro 1.13.0</li>
										    <li>前端框架: Bootstrap 3.3.7</li>
										    <li>前端界面: Thymeleaf </li>
										    <li>更多.....</li>
										</ol>
									</div>
								</div>
							</div>
                            <div class="panel panel-default">
								<div class="panel-heading">
								   <h5 class="panel-title">
									   <a data-toggle="collapse" data-parent="#version" href="#v477">v4.7.7</a><code class="pull-right">2023.04.14</code>
								   </h5>
								</div>
								<div id="v477" class="panel-collapse collapse">
									<div class="panel-body">
									   <ol>
									        <li>操作日志新增消耗时间属性</li>
									        <li>日志管理使用索引提升查询性能</li>
									        <li>日志注解支持排除指定的请求参数</li>
									        <li>新增监控页面图标显示</li>
									        <li>新增支持登录IP黑名单限制</li>
									        <li>更新fontawesome图标示例</li>
									        <li>屏蔽定时任务bean违规的字符</li>
									        <li>支持自定义隐藏属性列过滤子对象</li>
									        <li>连接池Druid支持新的配置connectTimeout和socketTimeout</li>
									        <li>升级jquery到最新版v3.6.3</li>
									        <li>升级layui到最新版本2.7.6</li>
									        <li>升级jasny-bootstrap到最新版4.0.0</li>
									        <li>升级oshi到最新版本6.4.1</li>
									        <li>升级druid到最新版本1.2.16</li>
									        <li>修复异步表格树子项排序问题</li>
									        <li>修复冻结列不支持IE浏览器的问题</li>
									        <li>修复主子表使用suggest插件无法新增问题</li>
									        <li>修复菜单栏快速点击导致展开折叠样式问题</li>
									        <li>修复用户多角色数据权限可能出现权限抬升的情况</li>
									        <li>修复异步加载表格树重置列表父节点展开异常问题</li>
									        <li>修复页签属性refresh为undefined时页面被刷新问题</li>
									        <li>移除apache/commons-fileupload依赖</li>
									        <li>优化前端属性提醒说明</li>
									        <li>优化用户导入更新时需获取用户编号问题</li>
									        <li>优化主子表根据序号删除方法加入表格ID参数</li>
									        <li>优化导出Excel时设置dictType属性重复查缓存问题</li>
									        <li>优化在线用户服务缓存改为从Bean容器获取不使用自动装配</li>
									        <li>优化表格示例行拖拽后列表底部总记录条数变成了undefined问题</li>
									        <li>其他细节优化</li>
										</ol>
									</div>
								</div>
							</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-sm-4">
                <div class="ibox float-e-margins">
                    <div class="ibox-title">
                        <h5>捐赠</h5>
                    </div>
                    <div class="ibox-content">
                        <div class="alert alert-warning">
                            	请作者喝杯咖啡（点击图片放大）
                        </div>
                        <p id="pay-qrcode">
                            <a href="javascript:;"><img th:src="@{/img/pay.png}" width="100%" alt="请使用手机支付宝或者微信扫码支付">
                            </a>
                        </p>

                    </div>
                </div>
            </div>
        </div>
    </div>
    <script th:src="@{/js/jquery.min.js}"></script>
    <script th:src="@{/js/bootstrap.min.js}"></script>
	<script th:src="@{/js/echarts.min.js}"></script>
	<script th:src="@{/ajax/libs/layer/layer.min.js}"></script>
    <script type="text/javascript">
	    $('#pay-qrcode').click(function(){
	        var html=$(this).html();
	        parent.layer.open({
	            title: false,
	            type: 1,
	            closeBtn:false,
	            shadeClose:true,
	            area: ['600px', '360px'],
	            content: html
	        });
	    });
	    //Echarts图表代码
		var myChart = echarts.init(document.getElementById('main-chart'));
		var option;
		option = {
			title: {
				text: '实验室热门设备图表',
				subtext: 'Fake Data',
				left: 'center'
			},
			tooltip: {
				trigger: 'item'
			},
			legend: {
				orient: 'vertical',
				left: 'left'
			},
			series: [
				{
					name: 'Access From',
					type: 'pie',
					radius: '50%',
					data: [
						{ value: 1048, name: '酒精灯' },
						{ value: 735, name: '试管' },
						{ value: 580, name: '烧杯' },
						{ value: 484, name: '砝码' },
						{ value: 300, name: '游标卡尺' }
					],
					emphasis: {
						itemStyle: {
							shadowBlur: 10,
							shadowOffsetX: 0,
							shadowColor: 'rgba(0, 0, 0, 0.5)'
						}
					}
				}
			]
		};

		if (option && typeof option === 'object') {
			myChart.setOption(option);
		}

		window.addEventListener('resize', myChart.resize);

    </script>
	<!--新增任务-->
	<script>
		<!--新增任务-->
		let counter = 0;
		function addTask() {
			const taskInput = document.getElementById('task');
			const taskText = taskInput.value.trim();
			if (taskText === '') return;
			const taskList = document.getElementById('taskList');
			const listItem = document.createElement('li');
			// 根据计数器的值切换类名
			const classNames = ['warning-element', 'success-element', 'info-element'];
			const className = classNames[counter % classNames.length];
			listItem.classList.add(className);
			counter++;// 计数器自增
			// 获取当前日期
			const currentDate = new Date();
			const year = currentDate.getFullYear();
			const month = (currentDate.getMonth() + 1).toString().padStart(2, '0');
			const day = currentDate.getDate();
			const dateString = `${year}.${month}.${day}`;
			//Html样式
			listItem.innerHTML = `
                ${taskText}
                <div class="agile-detail">
                <a href="javascript:;" class="pull-right btn btn-xs btn-white" th:onclick="'deleteTaskByTestId(' + ${task.taskId} +')'">删除</a>
				<!-- 根据 taskStatus 来设置按钮样式和文字 -->
				<a th:if="${task.taskStatus == '未完成'}" href="javascript:;" class="pull-right btn btn-xs btn-white" th:onclick="'updateTaskStatus('+ ${task.taskId}+')'">去完成</a>
				<a th:if="${task.taskStatus == '已完成'}" href="javascript:;" class="pull-right btn btn-xs btn-primary"  th:onclick="'updateTaskStatus('+ ${task.taskId}+')'">已完成</a>

               <i class="fa fa-clock-o"></i>${dateString}
                </div>
            `;
			//数据 用于传输至后台 ---> taskController
			const taskData = {
				userId: 1, // 这里可以设置当前登录用户的 ID
				taskDescription: taskText,
				taskDate: currentDate,
				taskStatus: '未完成',
			//	其他属性默认即可 未完成 已经默认时间
			};
			// 发送 AJAX 请求到后端保存任务
			$.ajax({
				url: '/api/addTask', // 后端接收添加任务的接口路径
				type: 'POST',
				contentType: 'application/json',
				data: JSON.stringify(taskData),
				success: function(response) {
					// 在成功保存任务后，刷新页面或者更新任务列表
					window.location.reload(); // 刷新页面
					// 或者更新任务列表的其他逻辑...
				},
				error: function(xhr, status, error) {
					// 处理请求出错的情况
					console.error('请求添加任务时出错：', error);
				}
			});
			taskList.appendChild(listItem);
			taskInput.value = '';

		}
	</script>
	<!--删除任务的js-->
	<script th:inline="javascript">
		function deleteTaskByTestId(taskId) {
			if (confirm('确定删除该任务吗？')) {
				// 发送 AJAX 请求到后端删除任务
				$.ajax({
					url: '/api/deleteTask',
					type: 'POST',
					data: {taskId: taskId},
					success: function(response) {
						// 在成功删除任务后，刷新页面
						window.location.reload();
					},
					error: function(xhr, status, error) {
						// 处理请求出错的情况
						console.error('请求删除任务时出错：', error);
					}
				});
			}
		}
	</script>
	<!--修改状态-->
	<script>
		function updateTaskStatus(taskId) {
			// 确认是否要修改任务状态
			if (confirm('确定修改' + taskId + '号任务状态吗？')) {
				// 发送 AJAX 请求到后端更新任务状态
				$.ajax({
					url: '/api/updateTaskStatus',
					type: 'POST',
					data: {taskId: taskId},
					success: function (response) {
						// 在成功更新任务状态后，刷新页面
						window.location.reload();
					},
					error: function (xhr, status, error) {
						// 处理请求出错的情况
						console.error('请求更新任务状态时出错：', error);
					}
				});
		}
		}
	</script>


</body>
</html>
